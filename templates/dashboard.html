{% extends "layout.html" %}
{% block title %}Your Dashboard{% endblock %}
{% block content %}
<div class="px-4 py-6 sm:px-0">
    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
        <h1 class="text-3xl font-bold text-gray-100">Welcome, {{ current_user.username }}!</h1>
        <a href="{{ url_for('simulate_day') }}" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg transition">Simulate New Day</a>
    </div>
    
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Main Content Column -->
        <div class="lg:col-span-2 space-y-8">

            <!-- AI-Powered Insights Section -->
            <div class="bg-gray-800 rounded-xl p-6 border border-emerald-800 shadow-lg">
                <h3 class="text-xl font-semibold text-emerald-400 mb-4 text-center">Today's Proactive Plan</h3>
                <div class="divide-y divide-gray-700">
                    
                    <!-- Environmental Advisor Card -->
                    {% if insights.environment %}
                    <div class="flex items-center gap-4 py-3">
                        <span class="text-2xl">🌦️</span>
                        <div>
                            <h4 class="font-semibold text-gray-200">{{ insights.environment.title }}</h4>
                            <p class="text-sm text-gray-400">{{ insights.environment.message }}</p>
                        </div>
                    </div>
                    {% endif %}
                    
                    <div class="text-center py-3">
                        <p class="text-gray-400">You have <strong class="text-sky-300">{{ free_hours }}</strong> free hours in your schedule today.</p>
                    </div>
                </div>
            </div>

            <!-- Log Your Data -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-gray-100 mb-4">Log Your Data for <span class="text-amber-300">{{ next_log_date }}</span></h3>
                <form action="{{ url_for('add_data') }}" method="post" class="space-y-6">
                    <input type="hidden" name="date" value="{{ next_log_date }}">
                    
                    <div class="flex items-center justify-center space-x-4">
                        <span class="text-2xl">😞</span>
                        {% for value, emoji in [('Stressed', '😞'), ('Tired', '😩'), ('Okay', '😐'), ('Good', '🙂'), ('Great', '😊')] %}
                        <div class="text-center">
                            <input type="radio" name="mood" value="{{ emoji }} {{ value }}" id="mood_{{value}}" class="peer hidden" required>
                            <label for="mood_{{value}}" class="text-4xl cursor-pointer peer-checked:opacity-100 opacity-50 transition transform peer-checked:scale-125" title="{{ value }}">{{ emoji }}</label>
                        </div>
                        {% endfor %}
                        <span class="text-2xl">😊</span>
                    </div>

                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <input type="number" name="steps" min="0" class="w-full px-3 py-2 bg-gray-700 rounded-md" placeholder="Steps" required>
                        <input type="number" name="sleep" step="0.1" min="0" class="w-full px-3 py-2 bg-gray-700 rounded-md" placeholder="Sleep (hours)" required>
                        <input type="number" name="heart_rate" min="0" class="w-full px-3 py-2 bg-gray-700 rounded-md" placeholder="Resting HR" required>
                        <input type="number" name="calories_burned" min="0" class="w-full px-3 py-2 bg-gray-700 rounded-md" placeholder="Exercise Calories" required>
                    </div>
                    <button type="submit" class="w-full bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg">Log This Day</button>
                </form>
            </div>
        </div>
        
        <!-- Right Sidebar -->
        <div class="space-y-8">
     <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
        <h3 class="text-xl font-semibold text-gray-100 text-center">Quick Actions</h3>
         <div class="mt-4 space-y-3">
            <a href="{{ url_for('exercise_plan') }}" class="block w-full text-center bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg">Get My Exercise Plan</a>
            <a href="{{ url_for('nutrition') }}" class="block w-full text-center bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg">Go to Nutrition Hub</a>
         </div>
     </div>
</div>
    </div>
</div>
{% endblock %}

